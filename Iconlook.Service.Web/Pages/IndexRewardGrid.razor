@inject HttpContextAccessor HttpContext
<style>
    .online-status {
        color: #00a1b3;
    }
</style>
<style media="(max-width: 769px)">
    .prep_reward {
        font-weight: 300 !important;
    }

    .prep_reward24h_change {
        margin-top: 3px !important;
    }

    #governance_grid .e-rowcell .fa-dot-circle {
        margin-top: 3px;
    }
</style>
<SfGrid RowHeight="40"
        EnableHover="false"
        EnableAltRow="false"
        ID="governance_grid"
        TValue="PRepResponse"
        AllowSelection="false"
        ClipMode="ClipMode.Ellipsis"
        GridLines="GridLine.Horizontal"
        Query="@(new Query().AddParams("take", 22))">
    <SfDataManager Url="/api/v1/prep/list" Adaptor="Adaptors.WebApiAdaptor"></SfDataManager>
    <GridColumns>
        <GridColumn Width="@((IsMobile ? 15 : 20).ToString())" Field="@nameof(PRepResponse.Ranking)">
            <Template>
                <i class="fad fs-n2 fa-dot-circle online-status"></i>
            </Template>
        </GridColumn>
        <GridColumn Width="@((IsMobile ? 30 : 40).ToString())" Field="@nameof(PRepResponse.Ranking)">
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <span class="mono font-weight-bold">@prep.Ranking</span>
                    }
                }
            </Template>
        </GridColumn>
        <GridColumn Field="@nameof(PRepResponse.Name)">
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <div class="d-flex align-items-center" style="margin-top: 1px;">
                            <img width="18" height="18" style="margin-top: -1px; margin-right: 8px;" src="@StringHelpers.ParseLogoUrl(prep.LogoUrl)">
                            <a class="prep_name secondary" href="https://tracker.icon.foundation/address/@prep.Id">@prep.Name</a>
                        </div>
                    }
                }
            </Template>
        </GridColumn>
        <GridColumn Visible="@(!IsMobile)" Width="130" TextAlign="TextAlign.Right" Field="@nameof(PRepResponse.MonthlyReward)">
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <span class="mono ls-n2 prep_reward">@prep.MonthlyReward.ToString("N0")</span>
                        <span class="pl-1 text-light font-weight-light">ICX</span>
                        <span style="margin-left: 1px;" class="fs-n1 text-light font-weight-light">/ month</span>
                    }
                }
            </Template>
        </GridColumn>
        @if (IsMobile)
        {
            <GridColumn Width="120" TextAlign="TextAlign.Right" Field="@nameof(PRepResponse.MonthlyRewardUsd)">
                <Template>
                    @{
                        if (context is PRepResponse prep)
                        {
                            <span class="mono fs-n1 font-weight-light">$</span>
                            <span class="mono ls-n2 prep_reward">@prep.MonthlyRewardUsd.ToString("N0")</span>
                            <span style="margin-left: 3px;" class="fs-n1 text-light font-weight-light">a month</span>
                        }
                    }
                </Template>
            </GridColumn>
        }
        else
        {
            <GridColumn Width="110" TextAlign="TextAlign.Right" Field="@nameof(PRepResponse.MonthlyRewardUsd)">
                <Template>
                    @{
                        if (context is PRepResponse prep)
                        {
                            <span class="mono fs-n1 font-weight-light">$</span>
                            <span class="mono ls-n2 prep_reward">@prep.MonthlyRewardUsd.ToString("N0")</span>
                            <span class="pl-1 text-light font-weight-light">USD</span>
                        }
                    }
                </Template>
            </GridColumn>
        }
    </GridColumns>
</SfGrid>

@code
{
    protected bool IsMobile;

    protected override bool ShouldRender()
    {
        return false;
    }

    protected override void OnInitialized()
    {
        IsMobile = HttpContext.Context.Request.Headers["User-Agent"].ToString().Contains("Mobile");
    }
}