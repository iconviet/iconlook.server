@code {
    [Parameter]
    public int PageSize { get; set; }

    [Parameter]
    public bool CanPage { get; set; }

    [Parameter]
    public string EditKey { get; set; }

    [Parameter]
    public object PageSizes { get; set; }

    public bool CanEdit => !string.IsNullOrWhiteSpace(EditKey);
}
<style>
    .fal.fa-star {
        opacity: 0.75;
        color: #ffdc85;
    }

    .fa-star:not(:last-child),
    .fa-star-half-alt:not(:last-child) { margin-right: 4px; }

    .fas.fa-star, .fas.fa-star-half-alt { color: #eebf4a; }
</style>
<EjsGrid EnableHover="false"
         EnableAltRow="true"
         TValue="PRepResponse"
         AllowPaging="@CanPage"
         AllowSelection="@CanEdit"
         ModelType="@PRepModelType"
         GridLines="@GridLine.Horizontal"
         Query="@($"new ej.data.Query().addParams('edit', '{EditKey}')")">
    <GridPageSettings PageSize="@PageSize" PageSizes="@PageSizes"></GridPageSettings>
    <GridEditSettings AllowEditing="@CanEdit" Mode="@EditMode.Dialog"></GridEditSettings>
    <EjsDataManager Url="/api/v1.0/preps" Adaptor="@Adaptors.WebApiAdaptor"></EjsDataManager>
    <GridColumns>
        <GridColumn Width="30" HeaderText="⇵" TextAlign="TextAlign.Center">
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        if (prep.Direction)
                        {
                            <i class="fas fa-caret-up positive-light" style="opacity: 0.75"></i>
                        }
                        else
                        {
                            <i class="fas fa-caret-down negative-light" style="opacity: 0.75"></i>
                        }
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
        <GridColumn Width="38" Field="@nameof(PRepResponse.Position)" HeaderText="&nbsp;#" DisableHtmlEncode="false">
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <span class="mono">@prep.Position</span>
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
        <GridColumn Width="233" Field="@nameof(PRepResponse.Name)" HeaderText="P-Rep" IsPrimaryKey="true">
            <HeaderTemplate>
                <span><i class='far pl-1 pr-2 fal fa-users'></i>&nbsp;P-Rep</span>
            </HeaderTemplate>
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <div class="d-flex align-items-center" style="margin-top: 1px;">
                            <img width="20" height="20" style="margin-right: 10px;" class="prep-@prep.IdExternal rounded-circle" alt="@prep.Name" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAtAQMAAADWcaq8AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAAA1JREFUeNpjYBgF9AAAAWgAAUrs9XsAAAAASUVORK5CYII=">
                            <a class="secondary @(prep.Position <= 22 ? "font-weight-semibolder": null)" href="address/hx47cd300865284000bdb154a90fc13e6a7bb2421e">@prep.Name</a>
                        </div>
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
        <GridColumn Width="75" Field="@nameof(PRepResponse.DelegatedPercentage)" HeaderText="Role" TextAlign="TextAlign.Center">
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <div class="text-center rounded-pill d-inline-block @(prep.Position <= 22 ? "bg-primary" : "bg-secondary")" style="width: 45px; margin: -2px 0; padding: 2px 0;">
                            <span class="fs-n1">@(prep.Position <= 22 ? "Main" : "Sub")</span>
                        </div>
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
        <GridColumn Width="75" Field="@nameof(PRepResponse.DelegatedPercentage)" HeaderText="Power" TextAlign="TextAlign.Center">
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <div class="text-center rounded-pill bg-secondary1 d-inline-block" style="width: 55px; margin: -2px 0; padding: 2px 0;">
                            <span class="fs-n1 mono @(prep.Position <= 22 ? "font-weight-semibolder": null)">@prep.DelegatedPercentage.ToString("P2")</span>
                        </div>
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
        <GridColumn Width="75" Field="@nameof(PRepResponse.LastSeen)" HeaderText="Status" TextAlign="TextAlign.Center">
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <div style="padding-top: 1px;">
                            <span class="positive-light">online</span>
                        </div>
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
        <GridColumn Width="85" Field="@nameof(PRepResponse.ProducedBlocks)" TextAlign="TextAlign.Center">
            <HeaderTemplate>
                <i class="far pr-2 fa-cube positive-dark"></i>
            </HeaderTemplate>
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <span class="mono ls-n2">@prep.ProducedBlocks.ToString("N0")</span>
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
        <GridColumn Width="55" Field="@nameof(PRepResponse.MissedBlocks)" TextAlign="TextAlign.Center">
            <HeaderTemplate>
                <i class="far pr-2 fa-cube negative-dark"></i>
            </HeaderTemplate>
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <span class="mono tx-light">@prep.MissedBlocks.ToString("N0")</span>
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
        <GridColumn Width="60" Field="@nameof(PRepResponse.ProductivityPercentage)" HeaderText="Uptime" TextAlign="TextAlign.Center">
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <span class="mono">99.95%</span>
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
        <GridColumn Width="125" Field="@nameof(PRepResponse.Votes)" TextAlign="TextAlign.Right" HeaderTextAlign="TextAlign.Right">
            <HeaderTemplate>
                <div class="pl-2">Vote Count</div>
            </HeaderTemplate>
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <span class="mono ls-n2">@prep.Votes.ToString("N0")</span>
                        <span class="pl-1 fs-n2 tx-light font-weight-light">votes</span>
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
        <GridColumn Width="65" HeaderText="% 24h" TextAlign="TextAlign.Right" Field="@nameof(PRepResponse.ProductivityPercentage)">
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        if (prep.ProductivityPercentage > 0)
                        {
                            <span class="mono positive-dark">@prep.ProductivityPercentage.ToString("P")</span>
                        }
                        if (prep.ProductivityPercentage < 0)
                        {
                            <span class="mono negative-dark">@prep.ProductivityPercentage.ToString("P")</span>
                        }
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
        <GridColumn Width="55" Field="@nameof(PRepResponse.Voters)" HeaderText="Voters" TextAlign="TextAlign.Right" Format="N0">
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <span class="mono">@prep.Voters.ToString("N0")</span>
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
        <GridColumn Width="135" Field="@nameof(PRepResponse.Balance)" TextAlign="TextAlign.Right">
            <HeaderTemplate>
                <span>Balance</span>
            </HeaderTemplate>
            <Template>
                @{
                    if (context is PRepResponse prep)
                    {
                        <span class="mono ls-n2">@prep.Balance.ToString("N0")</span>
                        <span class="pl-1 tx-light font-weight-light">ICX</span>
                    }
                }
            </Template>
            <EditTemplate />
        </GridColumn>
    </GridColumns>
</EjsGrid>
@code {
    public PRepResponse PRepModelType = new PRepResponse();
}
