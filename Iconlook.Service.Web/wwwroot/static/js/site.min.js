$(document).ready(function(){let n=[];const i=new rxjs.Subject;$("[data-toggle=tooltip]").tooltip({delay:{show:0}});const r=new EventSource("/sse/iconlook/stream?channel=iconlook");let t=parseInt($(".leader-block-mcount").text());r.addEventListener("error",function(n){console.log("ERROR",n)},!1);$(r).handleServerEvents({success:function(n,t,r){n.startsWith("cmd.on")||i.next({name:r.cmd,body:t})},handlers:{onReconnect:function(){console.log("[ICONLOOK] Channel re-connected.")},onConnect:function(){n.forEach(n=>{n.unsubscribe(),n=null});n=[];console.log("[ICONLOOK] Channel connected.");n.push(i.subscribe(()=>{if(t<=10){let n="",i="";for(let i=0;i<t;i++)n+="❚";for(let n=t;n<10;n++)i+="❚";$(".leader-block-mcount").text(t);$(".leader-block-elapse").text(n);$(".leader-block-remain").text(i)}}));n.push(i.pipe(rxjs.operators.filter(n=>n.name==="ChainUpdatedSignal")).pipe(rxjs.operators.auditTime(1e3)).subscribe(n=>{$(".ChainResponse_IcxPrice").money(n.body.chain.icxPrice,4),$(".ChainResponse_MarketCap").integer(n.body.chain.marketCap),$(".ChainResponse_IcxSupply").integer(n.body.chain.icxSupply),$(".ChainResponse_TotalStaked").integer(n.body.chain.totalStaked),$(".ChainResponse_TotalUnstaking").integer(n.body.chain.totalUnstaking),$(".ChainResponse_IcxCirculation").integer(n.body.chain.icxCirculation),$(".ChainResponse_RRepPercentage").percent(n.body.chain.rRepPercentage),$(".ChainResponse_PublicTreasury").integer(n.body.chain.publicTreasury),$(".ChainResponse_TotalDelegated").integer(n.body.chain.totalDelegated),$(".ChainResponse_NextTermLocalTime").text(n.body.chain.nextTermLocalTime),$(".ChainResponse_NextTermCountdown").text(n.body.chain.nextTermCountdown),$(".ChainResponse_TransactionCount").integer(n.body.chain.transactionCount),$(".ChainResponse_StakedPercentage").percent(n.body.chain.stakedPercentage),$(".ChainResponse_DelegatedPercentage").percent(n.body.chain.delegatedPercentage),$(".ChainResponse_StakingAddressCount").integer(n.body.chain.stakingAddressCount),$(".ChainResponse_NextTermBlockHeight").integer(n.body.chain.nextTermBlockHeight),$(".ChainResponse_IcxPriceChangePercentage").percent(n.body.chain.icxPriceChangePercentage)}));n.push(i.pipe(rxjs.operators.filter(n=>n.name==="PeersUpdatedSignal")).pipe(rxjs.operators.auditTime(1e3)).subscribe(n=>{n.body.busy!=null&&n.body.busy.forEach(function(n,i){i===0&&$(".leader-name").text()!==n.name&&(t=0,$(".leader-tile").hide(),$(".leader-tile").fadeIn(500),$(".leader-name").text(n.name),$(".leader-block-mcount").text("0"),$(".leader-block-elapse").text(null),$(".leader-logo").attr("src",n.logoUrl),$(".leader-ranking").text(`#${n.ranking}`),$(".leader-block-remain").text("❚❚❚❚❚❚❚❚❚❚"));const u=n.peerId.toString(),o=$(`.peer-name-${u}`),f=$(`.peer-state-${u}`),e=$(`.peer-state-${u} span`),r=$(`.peer-produced-blocks-${u}`);e.text()==="IDLE"&&(e.text("BUSY"),o.addClass("font-weight-bold"),f.addClass("peer-state-busy"),r.addClass("font-weight-semibold"),f.closest("tr").hide().fadeIn(500));$(".peer-state span").not(e).text("IDLE");$(".peer-name").not(o).removeClass("font-weight-bold");$(".peer-state").not(f).removeClass("peer-state-busy");$(".peer-produced-blocks").not(r).removeClass("font-weight-semibold");r.attr("number",parseInt(r.attr("number"))+1);r.text(parseInt(r.attr("number")).toLocaleString())})}));n.push(i.pipe(rxjs.operators.filter(n=>n.name==="BlockUpdatedSignal")).pipe(rxjs.operators.auditTime(1e3)).subscribe(n=>{if($(".block_height_icon").fadeOut(250),$(".BlockResponse_Height").integer(n.body.block.height),t+=1,$("#block_grid").length){if($("#block_grid .e-content tr").length>1){$("#block_grid .e-content tr").length>=22&&$("#block_grid .e-content tr:last").remove();const t=$("#block_grid .e-content tr:first").clone();t.find(".BlockResponse_TotalAmount").decimal(n.body.block.totalAmount,4,!0);t.find(".BlockResponse_BlockHeight").text(n.body.block.height.toLocaleString());t.find(".BlockResponse_BlockHash").text(`${n.body.block.hash.substring(0,12)}..`);t.find(".BlockResponse_TransactionCount").integer(n.body.block.transactionCount,"0000");t.hide().css("opacity",0).css("background-color","#ffffe1");t.prependTo($("#block_grid .e-content tbody:first"));t.slideDown(150).animate({opacity:1},450).animate({queue:!0,"background-color":"#ffffff"},300)}$("#block_grid .e-content tr").toArray().forEach(function(n,t){$(n).attr("aria-rowindex",t);$(n).attr("data-uid",`grid-row${t}`)})}$("#transaction_grid").length&&(n.body.transactions.forEach(function(n,t){if($("#transaction_grid .e-content tr").length>1){$("#transaction_grid .e-content tr").length>=22&&$("#transaction_grid .e-content tr:last").remove();const i=$("#transaction_grid .e-content tr:first").clone();i.attr("aria-rowindex",t).attr("data-uid",`grid-row${t}`);i.find(".TransactionResponse_Amount").decimal(n.amount,4,!0);i.find(".TransactionResponse_To").text(`${n.to.substring(0,10)}..`);i.find(".TransactionResponse_From").text(`${n.from.substring(0,10)}..`);i.find(".TransactionResponse_Hash").text(`${n.hash.substring(0,12)}..`);i.hide().css("opacity",0).css("background-color","#fffff0");i.prependTo($("#transaction_grid .e-content tbody:first"));i.slideDown(150).animate({opacity:1},450).animate({queue:!0,"background-color":"#ffffff"},300)}}),$("#transactions_grid .e-content tr").toArray().forEach(function(n,t){$(n).attr("aria-rowindex",t);$(n).attr("data-uid",`grid-row${t}`)}));$(".block_height_icon").fadeIn(500)}))}}})});