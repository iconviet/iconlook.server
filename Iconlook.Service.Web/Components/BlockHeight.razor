@using Serilog
@Height.ToString("N0")
@implements IDisposable
@code {
    private IDisposable _subscription;
    
    public long Height { get; set; }

    protected override void OnInitialized()
    {
        var connection = Source.Blockchain.Connect();
        _subscription = connection.Subscribe(x =>
        {
            Height = x.Last().Current.BlockHeight;
            InvokeAsync(() => StateHasChanged());
        });
        Log.Warning("BlockHeight.razor initialized");
    }
    
    public void Dispose()
    {
        _subscription.Dispose();
    }
}
